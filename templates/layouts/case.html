{% extends 'layouts/base.html' %}

{% load static %}

{% block back_link %}
	<div class="govuk-breadcrumbs">
		<ol class="govuk-breadcrumbs__list">
			<li class="govuk-breadcrumbs__list-item">
				<a class="govuk-breadcrumbs__link" href="{% url 'cases:cases' %}?queue={{ queue.queue.id }}">{% if queue_name %}{{ queue_name }}{% else %}{% lcs 'QUEUE_ALL_CASES' %}{% endif %}</a>
			</li>
			<li class="govuk-breadcrumbs__list-item" aria-current="page">
				{{ case.reference_code }}
			</li>
		</ol>
	</div>
{% endblock %}

{% block body %}
	{% if case.audit_notification %}
		<a id="audit-notification" class="lite-info-bar lite-info-bar--link lite-info-bar--no-animation" href="#case-activity-{{ case.audit_notification.audit_id }}">
			{% lcs 'CASE_CHANGES' %}
		</a>
	{% endif %}

	<div class="lite-app-bar">
		<div class="lite-app-bar__content">
			<p class="govuk-caption-m">{{ case.type.value }} by <a class="govuk-link govuk-link--no-visited-state" style="display: inline-block;" href="{% url 'organisations:organisation' case.application.organisation.id %}">{{ case.application.organisation.name }}</a></p>
			<h1 class="govuk-heading-l">
				{% block title %}
					{{ case.reference_code }}
				{% endblock %}
			</h1>
		</div>
		<div class="lite-app-bar__controls">
			<div class="lite-more-actions__container">
				<a role="button" draggable="false" class="govuk-button" href="{% url 'cases:documents' case.id %}">
		        	{% lcs 'CASES.ApplicationPage.Actions.DOCUMENT' %}
		        </a>
		        <a role="button" draggable="false" class="govuk-button" href="{% url 'cases:ecju_queries' case.id %}">
		            {% lcs 'CASES.ApplicationPage.Actions.ECJU' %}
				</a>
		        <a role="button" draggable="false" class="govuk-button" href="{% url 'cases:move' case.id %}">
					{% lcs 'CASES.ApplicationPage.Actions.MOVE' %}
				</a>
                {% if not status_is_terminal or 'REOPEN_CLOSED_CASES' in permissions %}
				<a role="button" draggable="false" class="govuk-button" id="change-status" href="{% url 'cases:manage' case.id %}">
					{% lcs 'CASES.ApplicationPage.Actions.CHANGE_STATUS' %}
				</a>
                {% endif %}
				{% if permissions|key_in_array:'MAKE_FINAL_DECISIONS' %}
					<a role="button" draggable="false" class="govuk-button" href="{% url 'cases:decide' case.id %}">
						{% lcs 'CASES.ApplicationPage.Actions.DECISION' %}
					</a>
				{% endif %}
		        <a role="button" draggable="false" class="govuk-button" href="{% url 'cases:user_advice_view' case.id %}">
					{% lcs 'CASES.ApplicationPage.Actions.ADVICE' %}
				</a>
                <a role="button" draggable="false" class="govuk-button" id="generate-document" href="{% url 'cases:generate_document' case.id %}">
					{% lcs 'CASES.ApplicationPage.Actions.GENERATE_DOCUMENT' %}
				</a>
                <a role="button" draggable="false" class="govuk-button" id="case-officer" href="{% url 'cases:case_officer' case.id %}">
                    {% lcs 'CASES.ApplicationPage.Actions.CASE_OFFICER' %}
                </a>
			</div>
		</div>
	</div>

    {% if case.case_officer %}
        <p class="govuk-caption-m">{% lcs 'Cases.ApplicationPage.CASE_OFFICER' %} <a class="govuk-link govuk-link--no-visited-state" href="{% url 'users:user' case.case_officer.id %}">{{ case.case_officer|username }}</a></p>
    {% else %}
        <p class="govuk-caption-m">{% lcs 'Cases.ApplicationPage.NO_CASE_OFFICER' %}</p>
    {% endif %}

	{% block detaails %}{% endblock %}
{% endblock %}

{% block javascript %}
	<script src="{% static 'javascripts/select-buttons.js' %}"></script>
	<script src="{% static 'more-actions.js' %}"></script>
{% endblock %}
