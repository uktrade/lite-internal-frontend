{% load humanize %}

<h3 class="govuk-heading-m">Goods</h3>
<table class="govuk-table" id="goods">
	<thead class="govuk-table__head">
		<tr class="govuk-table__row">
			<th class="govuk-table__header" scope="col">Description</th>
			<th class="govuk-table__header" scope="col">Control list entry</th>
			<th class="govuk-table__header" scope="col">Countries</th>
			<th class="govuk-table__header">{% lcs 'GOOD_CONTROLLED' %}</th>
			<th class="govuk-table__header">Flags</th>
			{% if show_advice %}
				<th class="govuk-table__header">Advice</th>
			{% endif %}
		</tr>
	</thead>
	<tbody class="govuk-table__body govuk-checkboxes govuk-checkboxes--small">
		{% for good in case.application.goods_types %}
			<tr class="govuk-table__row">
				<td class="govuk-table__cell">
					{% if show_checkboxes %}<div class="govuk-checkboxes__item">
						<input class="govuk-checkboxes__input" type="checkbox"
							{% if show_advice %}
								name="goods_types"
							{% else %}
								name="goods"
							{% endif %}
							value="{{ good.id }}" id="{{ good.id }}"> {% endif %}
						<label class="govuk-label {% if show_checkboxes %}govuk-checkboxes__label{% endif %}" for="{{ good.id }}">{{ good.description }}</label>
					{% if show_checkboxes %}</div>{% endif %}
				</td>
				<td class="govuk-table__cell">
					{% include 'includes/control-list-entries.html' with control_list_entries=good.control_list_entries %}
				<td class="govuk-table__cell">
					{% for country in good.countries %}
						<span class="app-country-tag">{{ country.id }}</span>
					{% empty %}
						{% for country in case.application.destinations.data %}
							<span class="app-country-tag">{{ country.id }}</span>
						{% endfor %}
					{% endfor %}
				</td>
				<td class="govuk-table__cell">
					{{ good.is_good_controlled|friendly_boolean }}
				</td>
				<td class="govuk-table__cell">
					{% include 'includes/flags.html' with flags=good.flags list=True %}
				</td>
				{% if show_advice %}
					<td class="govuk-table__cell">
						{% for advice in all_advice %}
							{% if advice.goods_type == good.id %}
								{% include 'case/views/table-advice.html' %}
							{% endif %}
						{% endfor %}
					</td>
				{% endif %}
			</tr>
		{% endfor %}
	</tbody>
</table>
<p class="govuk-body govuk-!-margin-top-3 govuk-!-font-weight-bold">{% lcs 'STANDARD_CASE_TOTAL_VALUE' %} Â£{{ total_goods_value|intcomma }}</p>


{% with third_parties=case.application.third_parties %}
	{% if third_parties %}
		<h3 class="govuk-heading-m">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.HEADING' %}</h3>
		<table class="govuk-table" id="third-parties">
			<thead class="govuk-table__head">
				<tr class="govuk-table__row">
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.NAME_COLUMN' %}</th>
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.TYPE_COLUMN' %}</th>
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.ROLE_COLUMN' %}</th>
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.ADDRESS_COLUMN' %}</th>
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.WEBSITE_COLUMN' %}</th>
					<th class="govuk-table__header" scope="col">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.DOCUMENT_COLUMN' %}</th>
					{% if show_advice %}
						<th class="govuk-table__header">{% lcs 'cases.ViewAdvicePage.ThirdPartyTable.ADVICE_COLUMN' %}</th>
					{% endif %}
				</tr>
			</thead>
			<tbody class="govuk-table__body">
				{% for third_party in third_parties %}
					<tr class="govuk-table__row">
						<td class="govuk-table__cell">
							<div class="govuk-checkboxes govuk-checkboxes--small">
								{% if show_checkboxes %}<div class="govuk-checkboxes__item">{% endif %}
									<input class="govuk-checkboxes__input" type="checkbox" name="third_parties" id="third_{{ third_party.id}}" value="{{ third_party.id }}">
									<label class="govuk-label {% if show_checkboxes %}govuk-checkboxes__label{% endif %}" for="third_{{ third_party.id}}">{{ third_party.name }}</label>
								{% if show_checkboxes %}</div>{% endif %}
							</div>
						</td>
						<td class="govuk-table__cell">
							{{ third_party.sub_type.value }}
						</td>
						<td class="govuk-table__cell">
							{{ third_party.role.value }}
						</td>
						<td class="govuk-table__cell">
							{{ third_party.address }}, {{ third_party.country.name }}
						</td>
						<td class="govuk-table__cell">
							{{ third_party.website|default:'Not set' }}
						</td>
						<td class="govuk-table__cell">
						{% if third_party.document.safe == True %}
							<a class="govuk-link govuk-link--no-visited-state" id="third_party_document" href="{% url 'cases:document' queue.id case.id third_party.document.id %}">
								<span class="govuk-visually-hidden">{% lcs 'cases.Manage.Documents.DOWNLOAD_DOCUMENT' %}</span>
								{{ third_party.document.name }}<br>
							</a>
						{% endif %}
						</td>
						{% if show_advice %}
							<td class="govuk-table__cell">
								{% for advice in all_advice %}
									{% if advice.third_party == third_party.id %}
										{% include 'case/views/table-advice.html' %}
									{% endif %}
								{% endfor %}
							</td>
						{% endif %}
					</tr>
				{% endfor %}
			</tbody>
		</table>
	{% endif %}
{% endwith %}
