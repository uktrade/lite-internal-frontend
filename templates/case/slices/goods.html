{% load humanize %}

<h2 class="govuk-heading-m">{{ case.goods|length }} good{{ case.goods|pluralize }}</h2>

{% if not hide_controls %}
	<form action="{% url 'cases:review_goods' queue.id case.id %}" method="get">
		{% csrf_token %}
		{% if 'REVIEW_GOODS' in permissions and not status_is_terminal %}
			<button id="button-review-goods" name="action" value="review-goods" class="govuk-button" data-module="govuk-button">
				{% lcs 'cases.ApplicationPage.REVIEW_GOODS' %}
			</button>
		{% endif %}
		<button id="button-edit-goods-flags" name="action" value="edit-flags" class="govuk-button" data-module="govuk-button">
			{% lcs 'cases.ApplicationPage.EDIT_FLAGS' %}
		</button>
{% endif %}

{% if case.application.goods %}
	<table id="table-goods" class="govuk-table">
		<thead class="govuk-table__head">
			<tr class="govuk-table__row">
				<th scope="col" class="govuk-table__header">
					<button id="link-select-all-goods" type="button" name="button" class="lite-button-checkbox" title="{% lcs 'cases.ApplicationPage.Parties.SELECT_ALL' %}"></button>
				</th>
				<th scope="col" class="govuk-table__header">#</th>
				<th scope="col" class="govuk-table__header">Description</th>
				<th scope="col" class="govuk-table__header">Value</th>
				<th scope="col" class="govuk-table__header">Controlled</th>
				<th scope="col" class="govuk-table__header">Control list entries</th>
				<th scope="col" class="govuk-table__header">Incorporated</th>
				<th scope="col" class="govuk-table__header">Flags</th>
			</tr>
		</thead>
		<tbody class="govuk-table__body">
			{% for good in case.application.goods %}
				<tr class="govuk-table__row">
					<td class="govuk-table__cell govuk-table__cell--checkbox {% if show_advice %}lite-!-no-border{% endif %}">
						<input class="govuk-checkboxes__input" type="checkbox" name="goods" value="{{ good.good.id }}" id="{{ good.id }}">
						<label class="govuk-label govuk-checkboxes__label" for="{{ good.good.id }}"></label>
					</td>
					<td class="govuk-table__cell govuk-table__cell--line-number {% if show_advice %}lite-!-no-border{% endif %}">{{ forloop.counter }}.</td>
					<td class="govuk-table__cell govuk-table__cell--max-width-400 {% if show_advice %}lite-!-no-border{% endif %}">
						<span data-max-length="200">{{ good.good.description }}</span>
					</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">{{ good.quantity }} {{ good.unit.value }}/Â£{{ good.value|intcomma }}</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">{{ good.good.is_good_controlled.value }}</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">
						{% include 'includes/control-list-entries.html' with control_list_entries=good.good.control_list_entries %}
					</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">{{ good.is_good_incorporated|friendly_boolean }}</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">
						{% include 'includes/flags.html' with flags=good.good.flags list=True %}
					</td>
				</tr>
				{% if show_advice %}
					{% include 'includes/advice.html' with advice_list=good.advice %}
				{% endif %}
			{% endfor %}
		</tbody>
	</table>
{% endif %}
{% if case.application.goods_types %}
	<table id="table-goods" class="govuk-table">
		<thead class="govuk-table__head">
			<tr class="govuk-table__row">
				<th scope="col" class="govuk-table__header">
					<button id="link-select-all-goods" type="button" name="button" class="lite-button-checkbox" title="{% lcs 'cases.ApplicationPage.Parties.SELECT_ALL' %}"></button>
				</th>
				<th scope="col" class="govuk-table__header">#</th>
				<th scope="col" class="govuk-table__header">Description</th>
				<th scope="col" class="govuk-table__header">Controlled</th>
				<th scope="col" class="govuk-table__header">Control list entries</th>
				<th scope="col" class="govuk-table__header">Incorporated</th>
				<th scope="col" class="govuk-table__header">Countries</th>
				<th scope="col" class="govuk-table__header">Flags</th>
			</tr>
		</thead>
		<tbody class="govuk-table__body">
			{% for good in case.application.goods_types %}
				<tr class="govuk-table__row">
					<td class="govuk-table__cell govuk-table__cell--checkbox {% if show_advice %}lite-!-no-border{% endif %}">
						<input class="govuk-checkboxes__input" type="checkbox" name="goods" value="{{ good.id }}" id="{{ good.id }}">
						<label class="govuk-label govuk-checkboxes__label" for="{{ good.id }}"></label>
					</td>
					<td class="govuk-table__cell govuk-table__cell--line-number {% if show_advice %}lite-!-no-border{% endif %}">{{ forloop.counter }}.</td>
					<td class="govuk-table__cell govuk-table__cell--max-width-400 {% if show_advice %}lite-!-no-border{% endif %}">
						<span data-max-length="200">{{ good.description }}</span>
					</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">{{ good.is_good_controlled|friendly_boolean }}</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">
						{% include 'includes/control-list-entries.html' with control_list_entries=good.control_list_entries %}
					</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">{{ good.is_good_incorporated|friendly_boolean }}</td>
					<td class="govuk-table__cell govuk-table__cell--max-width-300 {% if show_advice %}lite-!-no-border{% endif %}">
						<span data-max-length="200">
							{% for country in good.countries %}
								{{ country.name }}{% if not forloop.last %}, {% endif %}
							{% endfor %}
						</span>
					</td>
					<td class="govuk-table__cell {% if show_advice %}lite-!-no-border{% endif %}">
						{% include 'includes/flags.html' with flags=good.flags list=True %}
					</td>
				</tr>
				{% if show_advice %}
					{% include 'includes/advice.html' with advice_list=good.advice %}
				{% endif %}
			{% endfor %}
		</tbody>
	</table>
{% endif %}

{% if not hide_controls %}
	</form>
{% endif %}
