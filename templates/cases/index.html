{% extends 'layouts/full_width.html' %}

{% load humanize %}

{% block back-button %}{% endblock %}

{% block body %}

<form action="" method="get" class="lite-dropdown-select">
	<select class="govuk-select" name="queue">
		{% for queue in queues.queues %}
		<option value="{{ queue.id }}" {% if queue.id == queue_id %}selected{% endif %}>{{ queue.name }}</option>
		{% endfor %}
	</select>
	<button type="submit" class="govuk-button">{% get_string 'cases.go_to_queue' %}</button>
</form>

<div class="lite-dropdown-background" onclick="toggleDropdown()"></div>

<!-- <div class="lite-tabs--fade">
		<div class="lite-tabs">
			<a class="lite-tabs__tab selected">Cases</a>
			<!--<a class="lite-tabs__tab">Queries</a>
		</div>
	</div> -->

<form method="post">

	{% csrf_token %}

	<div class="lite-app-bar">
		<div class="">
			<a id="queue-title" href="#" class="govuk-heading-l lite-heading-dropdown" onclick="toggleDropdown()">{{ title }}</a>

			<div class="lite-dropdown--container" id="queues">
				<div class="lite-dropdown">
					{% for queue in queues.queues %}
					<a href="/cases/?queue={{ queue.id }}" class="lite-dropdown--item {% if queue.id == queue_id %}lite-dropdown--item--selected{% endif %}">{{ queue.name }}</a>
					{% endfor %}
				</div>
			</div>
		</div>
		<div class="lite-app-bar--right">
			<button type="submit" class="govuk-button govuk-button--secondary">Assign users</button>
		</div>
	</div>

	{% if data.queue.cases|length %}

		<div class="lite-cases-table">
			<div class="lite-cases-table-header">
				<h4>
					<div class="govuk-checkboxes govuk-checkboxes--small" style="display: none;">
						<div class="govuk-checkboxes__item">
							<input class="govuk-checkboxes__input" type="checkbox">
							<label class="govuk-label govuk-checkboxes__label" for="organisation-1"></label>
						</div>
					</div>
				</h4>
				<h4>
					Case
				</h4>
				<!-- <h4>
					Goods
				</h4>
				<h4>
					Destinations
				</h4>
				<h4>
					Queue
				</h4>
				<h4>
					Flags
				</h4> -->
				<h4>
					Status
				</h4>
			</div>
			{% for case in data.queue.cases %}
				<div class="lite-cases-table-row">
					<div class="govuk-checkboxes govuk-checkboxes--small">
						<div class="govuk-checkboxes__item">
							<input class="govuk-checkboxes__input" type="checkbox" name="cases" value="{{ case.id }}">
							<label class="govuk-label govuk-checkboxes__label"></label>
						</div>
					</div>
					<div>
						<a href="{% url 'cases:case' case.id %}" class="govuk-link govuk-!-font-size-19 govuk-link--no-visited-state govuk-!-font-weight-bold" href="#" style="text-decoration: none; margin-bottom: 5px!important; display: block;">
							{{ case.application.id|default:"Untitled" }}
						</a>
						<p class="govuk-body govuk-!-font-size-16" style="opacity: .7; margin: 0;">
							{{ case.application.organisation.name }}
						</p>
					</div>
					<p class="govuk-body">
						{{ case.application.status|default:"Untitled"|sentence_case }}
					</p>
				</div>
			{% endfor %}
		</div>
	{% else %}
		<p class="govuk-caption-l">{% get_string 'cases.no_cases' %}</p>
	{% endif %}

</form>

<script>
	function toggleDropdown() {
		$(".lite-dropdown-background").toggle();
		$("#queues").toggleClass('lite-dropdown--visible');
		$("#queue-title").toggleClass("lite-heading-dropdown--flipped");
	}
</script>

{% endblock %}
